!function(t,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?module.exports=o():t.PortalClient=o()}(this,function(){function t(t){if(this.path=t.path,this.origin=t.origin,this.callbacks={},window.location.origin=window.location.origin||window.location.protocol+"//"+window.location.host,!window.parent.postMessage)throw new Error("Browser does not support postMessage!")}return t.prototype.on=function(t,o){this.callbacks[t]=o},t.prototype.start=function(t){window.addEventListener("message",function(t){(t.origin||t.originalEvent.origin)===this.origin&&this.callbacks[t.data.type]&&this.callbacks[t.data.type](t.data.payload)}.bind(this)),this.insertFrame(t)},t.prototype.insertFrame=function(t){var o=document.createElement("iframe");o.src=this.origin+this.path+"?src="+encodeURIComponent(window.location.origin),o.style.visibility="hidden",o.onload=function(){this.contentWindow=o.contentWindow,t&&t()}.bind(this),document.body.appendChild(o)},t.prototype.send=function(t,o){if(!this.contentWindow)throw new Error("Cannot send event; frame not loaded");this.contentWindow.postMessage({type:t,payload:o},this.origin)},t});